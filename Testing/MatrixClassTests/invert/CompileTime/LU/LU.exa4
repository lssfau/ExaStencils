
Domain global< [ 0, 0 ] to [ 0.1, 0.1 ] >

Globals {
}

/// main function

Function Application ( ) : Unit {

	Var nopiv : Matrix<Real, 5, 5> = {{576.0, -144, 0, 0, 12}, {-144, 576, 0, 0, -12}, {0, 0, 576, -144, 12 }, {0, 0, -144, 576, -12}, {-12, 12, -12, 12, 0	}}
	Var nopiv_i : Matrix<Real, 5 ,5> 
	//nopiv_i = inverse({{576.0, -144, 0, 0, 12}, {-144, 576, 0, 0, -12}, {0, 0, 576, -144, 12 }, {0, 0, -144, 576, -12}, {-12, 12, -12, 12, 0	}})
	nopiv_i = inverse(nopiv, shape="LU")
		
Var nopiv_sol : Matrix<Real, 5, 5> = {{ 0.0015046296296296296296,	0.00081018518518518518513,	-0.00034722222222222222218,	0.00034722222222222222218,	-0.020833333333333333332},
{	0.00081018518518518518514,	0.0015046296296296296296,	0.00034722222222222222218,	-0.00034722222222222222218,	0.020833333333333333332},
{	-0.00034722222222222222218,	0.00034722222222222222218,	0.0015046296296296296296,	0.00081018518518518518513,	-0.020833333333333333332},
{	0.00034722222222222222218,	-0.00034722222222222222218,	0.00081018518518518518514,	0.0015046296296296296296,	0.020833333333333333332},
{	0.020833333333333333332,	-0.020833333333333333332,	0.020833333333333333332,	-0.020833333333333333332,	1.25}}
	
	compare(nopiv_i, nopiv_sol, 0.000001)
	print('stage 0 done')

	// nan nan ...?
	Var piv_2 : Matrix<Real, 5, 5> = {{3.0, 2, 1, 0,1}, {4, 2, 1, 2,1}, {4, 1, 3, 2,1}, {1, 1, 2, 3,2}, {1, 1, 2, 3,9}}
	//piv_2 = 1
	Var piv_2_i : Matrix<Real, 5 ,5> 
	piv_2_i = inverse(piv_2, shape="LU")
	Var piv_2_sol : Matrix<Real, 5, 5> = {{-0.2413793103448275862,	0.31034482758620689654,	0.20689655172413793104,	-0.40394088669950738916,	0.059113300492610837438},
{	0.68965517241379310344,	-0.17241379310344827586,	-0.44827586206896551724,	0.54187192118226600985,	-0.12807881773399014778},
{0.34482758620689655171,	-0.58620689655172413792,	0.27586206896551724136,	0.27093596059113300493,	-0.064039408866995073891},
{-0.37931034482758620689,	0.34482758620689655172,	-0.10344827586206896551,	0.20197044334975369457,	-0.029556650246305418717},
{	0,	0,	0,	-0.14285714285714285714,	0.14285714285714285714}}
	
	compare(piv_2_i, piv_2_sol, 0.000001)
	print('stage 1 done')

	Var e1 : Double = 0.19166575114224305
	Var m3 : Matrix<Real, 4, 4> = {
{
e1, 0.0975349411200147, 0.16461771661760427, 0.5446326430058404 },
{
0.6784953006038077, 0.7778041990475592, 0.04530333129215014, 0.11364490709584574 },
{
0.36188415586058265, 0.9045400707877311, 0.4736412037583797, 0.03516084366822503 },
{
0.5645616881900813, 0.012840178817936532, 0.9481734388557158, 0.8385214816095217 }
}
	
	Var m3_i : Matrix<Real, 4 ,4> 
	m3_i = inverse(m3, "shape=LU")
	Var m3_sol : Matrix<Real, 4, 4> = {
{
-1.8306053878110888, 1.9847287459880598, -1.5232223553043553, 0.9838876378446867 },
{
1.2857501927693693, -0.340724264071359, 1.2718353632331822, -0.8422667376633881 },
{
-1.2519277357532057, -0.8371893511060012, 0.842231025878121, 0.891294356270601 },
{
2.6284657942686525, -0.3843981961271361, 0.05371514478593696, -0.4648086586364101 }
}
	

	compare(m3_i, m3_sol, 0.000001)
	print('stage 2 done')

}

